{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createStoreConfig = createStoreConfig;\nexports.transformStore = transformStore;\nexports.createStoreFromObject = createStoreFromObject;\nexports.createStoreFromClass = createStoreFromClass;\n\nvar _AltUtils = require('../utils/AltUtils');\n\nvar utils = _interopRequireWildcard(_AltUtils);\n\nvar _functions = require('../functions');\n\nvar fn = _interopRequireWildcard(_functions);\n\nvar _AltStore = require('./AltStore');\n\nvar _AltStore2 = _interopRequireDefault(_AltStore);\n\nvar _StoreMixin = require('./StoreMixin');\n\nvar _StoreMixin2 = _interopRequireDefault(_StoreMixin);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj['default'] = obj;\n    return newObj;\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nfunction doSetState(store, storeInstance, state) {\n  if (!state) {\n    return;\n  }\n\n  var config = storeInstance.StoreModel.config;\n  var nextState = fn.isFunction(state) ? state(storeInstance.state) : state;\n  storeInstance.state = config.setState.call(store, storeInstance.state, nextState);\n\n  if (!store.alt.dispatcher.isDispatching()) {\n    store.emitChange();\n  }\n}\n\nfunction createPrototype(proto, alt, key, extras) {\n  return fn.assign(proto, _StoreMixin2['default'], {\n    displayName: key,\n    alt: alt,\n    dispatcher: alt.dispatcher,\n    preventDefault: function () {\n      function preventDefault() {\n        this.getInstance().preventDefault = true;\n      }\n\n      return preventDefault;\n    }(),\n    boundListeners: [],\n    lifecycleEvents: {},\n    actionListeners: {},\n    publicMethods: {},\n    handlesOwnErrors: false\n  }, extras);\n}\n\nfunction createStoreConfig(globalConfig, StoreModel) {\n  StoreModel.config = fn.assign({\n    getState: function () {\n      function getState(state) {\n        if (Array.isArray(state)) {\n          return state.slice();\n        } else if (fn.isMutableObject(state)) {\n          return fn.assign({}, state);\n        }\n\n        return state;\n      }\n\n      return getState;\n    }(),\n    setState: function () {\n      function setState(currentState, nextState) {\n        if (fn.isMutableObject(nextState)) {\n          return fn.assign(currentState, nextState);\n        }\n\n        return nextState;\n      }\n\n      return setState;\n    }()\n  }, globalConfig, StoreModel.config);\n}\n\nfunction transformStore(transforms, StoreModel) {\n  return transforms.reduce(function (Store, transform) {\n    return transform(Store);\n  }, StoreModel);\n}\n\nfunction createStoreFromObject(alt, StoreModel, key) {\n  var storeInstance = void 0;\n  var StoreProto = createPrototype({}, alt, key, fn.assign({\n    getInstance: function () {\n      function getInstance() {\n        return storeInstance;\n      }\n\n      return getInstance;\n    }(),\n    setState: function () {\n      function setState(nextState) {\n        doSetState(this, storeInstance, nextState);\n      }\n\n      return setState;\n    }()\n  }, StoreModel)); // bind the store listeners\n\n  /* istanbul ignore else */\n\n  if (StoreProto.bindListeners) {\n    _StoreMixin2['default'].bindListeners.call(StoreProto, StoreProto.bindListeners);\n  }\n  /* istanbul ignore else */\n\n\n  if (StoreProto.observe) {\n    _StoreMixin2['default'].bindListeners.call(StoreProto, StoreProto.observe(alt));\n  } // bind the lifecycle events\n\n  /* istanbul ignore else */\n\n\n  if (StoreProto.lifecycle) {\n    fn.eachObject(function (eventName, event) {\n      _StoreMixin2['default'].on.call(StoreProto, eventName, event);\n    }, [StoreProto.lifecycle]);\n  } // create the instance and fn.assign the public methods to the instance\n\n\n  storeInstance = fn.assign(new _AltStore2['default'](alt, StoreProto, StoreProto.state !== undefined ? StoreProto.state : {}, StoreModel), StoreProto.publicMethods, {\n    displayName: key,\n    config: StoreModel.config\n  });\n  return storeInstance;\n}\n\nfunction createStoreFromClass(alt, StoreModel, key) {\n  var storeInstance = void 0;\n  var config = StoreModel.config; // Creating a class here so we don't overload the provided store's\n  // prototype with the mixin behaviour and I'm extending from StoreModel\n  // so we can inherit any extensions from the provided store.\n\n  var Store = function (_StoreModel) {\n    _inherits(Store, _StoreModel);\n\n    function Store() {\n      _classCallCheck(this, Store);\n\n      for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      return _possibleConstructorReturn(this, _StoreModel.call.apply(_StoreModel, [this].concat(args)));\n    }\n\n    return Store;\n  }(StoreModel);\n\n  createPrototype(Store.prototype, alt, key, {\n    type: 'AltStore',\n    getInstance: function () {\n      function getInstance() {\n        return storeInstance;\n      }\n\n      return getInstance;\n    }(),\n    setState: function () {\n      function setState(nextState) {\n        doSetState(this, storeInstance, nextState);\n      }\n\n      return setState;\n    }()\n  });\n\n  for (var _len = arguments.length, argsForClass = Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n    argsForClass[_key - 3] = arguments[_key];\n  }\n\n  var store = new (Function.prototype.bind.apply(Store, [null].concat(argsForClass)))();\n  /* istanbul ignore next */\n\n  if (config.bindListeners) store.bindListeners(config.bindListeners);\n  /* istanbul ignore next */\n\n  if (config.datasource) store.registerAsync(config.datasource);\n  storeInstance = fn.assign(new _AltStore2['default'](alt, store, store.state !== undefined ? store.state : store, StoreModel), utils.getInternalMethods(StoreModel), config.publicMethods, {\n    displayName: key\n  });\n  return storeInstance;\n}","map":{"version":3,"sources":["D:/Projects/W_e_e_b/my-app/node_modules/alt/lib/store/index.js"],"names":["Object","defineProperty","exports","value","createStoreConfig","transformStore","createStoreFromObject","createStoreFromClass","_AltUtils","require","utils","_interopRequireWildcard","_functions","fn","_AltStore","_AltStore2","_interopRequireDefault","_StoreMixin","_StoreMixin2","obj","__esModule","newObj","key","prototype","hasOwnProperty","call","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","doSetState","store","storeInstance","state","config","StoreModel","nextState","isFunction","setState","alt","dispatcher","isDispatching","emitChange","createPrototype","proto","extras","assign","displayName","preventDefault","getInstance","boundListeners","lifecycleEvents","actionListeners","publicMethods","handlesOwnErrors","globalConfig","getState","Array","isArray","slice","isMutableObject","currentState","transforms","reduce","Store","transform","StoreProto","bindListeners","observe","lifecycle","eachObject","eventName","event","on","undefined","_StoreModel","_len2","arguments","length","args","_key2","apply","concat","type","_len","argsForClass","_key","Function","bind","datasource","registerAsync","getInternalMethods"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createStoreConfig = createStoreConfig;\nexports.transformStore = transformStore;\nexports.createStoreFromObject = createStoreFromObject;\nexports.createStoreFromClass = createStoreFromClass;\n\nvar _AltUtils = require('../utils/AltUtils');\n\nvar utils = _interopRequireWildcard(_AltUtils);\n\nvar _functions = require('../functions');\n\nvar fn = _interopRequireWildcard(_functions);\n\nvar _AltStore = require('./AltStore');\n\nvar _AltStore2 = _interopRequireDefault(_AltStore);\n\nvar _StoreMixin = require('./StoreMixin');\n\nvar _StoreMixin2 = _interopRequireDefault(_StoreMixin);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction doSetState(store, storeInstance, state) {\n  if (!state) {\n    return;\n  }\n\n  var config = storeInstance.StoreModel.config;\n\n\n  var nextState = fn.isFunction(state) ? state(storeInstance.state) : state;\n\n  storeInstance.state = config.setState.call(store, storeInstance.state, nextState);\n\n  if (!store.alt.dispatcher.isDispatching()) {\n    store.emitChange();\n  }\n}\n\nfunction createPrototype(proto, alt, key, extras) {\n  return fn.assign(proto, _StoreMixin2['default'], {\n    displayName: key,\n    alt: alt,\n    dispatcher: alt.dispatcher,\n    preventDefault: function () {\n      function preventDefault() {\n        this.getInstance().preventDefault = true;\n      }\n\n      return preventDefault;\n    }(),\n\n    boundListeners: [],\n    lifecycleEvents: {},\n    actionListeners: {},\n    publicMethods: {},\n    handlesOwnErrors: false\n  }, extras);\n}\n\nfunction createStoreConfig(globalConfig, StoreModel) {\n  StoreModel.config = fn.assign({\n    getState: function () {\n      function getState(state) {\n        if (Array.isArray(state)) {\n          return state.slice();\n        } else if (fn.isMutableObject(state)) {\n          return fn.assign({}, state);\n        }\n\n        return state;\n      }\n\n      return getState;\n    }(),\n    setState: function () {\n      function setState(currentState, nextState) {\n        if (fn.isMutableObject(nextState)) {\n          return fn.assign(currentState, nextState);\n        }\n        return nextState;\n      }\n\n      return setState;\n    }()\n  }, globalConfig, StoreModel.config);\n}\n\nfunction transformStore(transforms, StoreModel) {\n  return transforms.reduce(function (Store, transform) {\n    return transform(Store);\n  }, StoreModel);\n}\n\nfunction createStoreFromObject(alt, StoreModel, key) {\n  var storeInstance = void 0;\n\n  var StoreProto = createPrototype({}, alt, key, fn.assign({\n    getInstance: function () {\n      function getInstance() {\n        return storeInstance;\n      }\n\n      return getInstance;\n    }(),\n    setState: function () {\n      function setState(nextState) {\n        doSetState(this, storeInstance, nextState);\n      }\n\n      return setState;\n    }()\n  }, StoreModel));\n\n  // bind the store listeners\n  /* istanbul ignore else */\n  if (StoreProto.bindListeners) {\n    _StoreMixin2['default'].bindListeners.call(StoreProto, StoreProto.bindListeners);\n  }\n  /* istanbul ignore else */\n  if (StoreProto.observe) {\n    _StoreMixin2['default'].bindListeners.call(StoreProto, StoreProto.observe(alt));\n  }\n\n  // bind the lifecycle events\n  /* istanbul ignore else */\n  if (StoreProto.lifecycle) {\n    fn.eachObject(function (eventName, event) {\n      _StoreMixin2['default'].on.call(StoreProto, eventName, event);\n    }, [StoreProto.lifecycle]);\n  }\n\n  // create the instance and fn.assign the public methods to the instance\n  storeInstance = fn.assign(new _AltStore2['default'](alt, StoreProto, StoreProto.state !== undefined ? StoreProto.state : {}, StoreModel), StoreProto.publicMethods, {\n    displayName: key,\n    config: StoreModel.config\n  });\n\n  return storeInstance;\n}\n\nfunction createStoreFromClass(alt, StoreModel, key) {\n  var storeInstance = void 0;\n  var config = StoreModel.config;\n\n  // Creating a class here so we don't overload the provided store's\n  // prototype with the mixin behaviour and I'm extending from StoreModel\n  // so we can inherit any extensions from the provided store.\n\n  var Store = function (_StoreModel) {\n    _inherits(Store, _StoreModel);\n\n    function Store() {\n      _classCallCheck(this, Store);\n\n      for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      return _possibleConstructorReturn(this, _StoreModel.call.apply(_StoreModel, [this].concat(args)));\n    }\n\n    return Store;\n  }(StoreModel);\n\n  createPrototype(Store.prototype, alt, key, {\n    type: 'AltStore',\n    getInstance: function () {\n      function getInstance() {\n        return storeInstance;\n      }\n\n      return getInstance;\n    }(),\n    setState: function () {\n      function setState(nextState) {\n        doSetState(this, storeInstance, nextState);\n      }\n\n      return setState;\n    }()\n  });\n\n  for (var _len = arguments.length, argsForClass = Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n    argsForClass[_key - 3] = arguments[_key];\n  }\n\n  var store = new (Function.prototype.bind.apply(Store, [null].concat(argsForClass)))();\n\n  /* istanbul ignore next */\n  if (config.bindListeners) store.bindListeners(config.bindListeners);\n  /* istanbul ignore next */\n  if (config.datasource) store.registerAsync(config.datasource);\n\n  storeInstance = fn.assign(new _AltStore2['default'](alt, store, store.state !== undefined ? store.state : store, StoreModel), utils.getInternalMethods(StoreModel), config.publicMethods, { displayName: key });\n\n  return storeInstance;\n}"]},"metadata":{},"sourceType":"script"}