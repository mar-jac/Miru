{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _functions = require('../functions');\n\nvar fn = _interopRequireWildcard(_functions);\n\nvar _transmitter = require('transmitter');\n\nvar _transmitter2 = _interopRequireDefault(_transmitter);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj['default'] = obj;\n    return newObj;\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nvar AltStore = function () {\n  function AltStore(alt, model, state, StoreModel) {\n    var _this = this;\n\n    _classCallCheck(this, AltStore);\n\n    var lifecycleEvents = model.lifecycleEvents;\n    this.transmitter = (0, _transmitter2['default'])();\n\n    this.lifecycle = function (event, x) {\n      if (lifecycleEvents[event]) lifecycleEvents[event].publish(x);\n    };\n\n    this.state = state;\n    this.alt = alt;\n    this.preventDefault = false;\n    this.displayName = model.displayName;\n    this.boundListeners = model.boundListeners;\n    this.StoreModel = StoreModel;\n\n    this.reduce = model.reduce || function (x) {\n      return x;\n    };\n\n    this.subscriptions = [];\n\n    var output = model.output || function (x) {\n      return x;\n    };\n\n    this.emitChange = function () {\n      return _this.transmitter.publish(output(_this.state));\n    };\n\n    var handleDispatch = function handleDispatch(f, payload) {\n      try {\n        return f();\n      } catch (e) {\n        if (model.handlesOwnErrors) {\n          _this.lifecycle('error', {\n            error: e,\n            payload: payload,\n            state: _this.state\n          });\n\n          return false;\n        }\n\n        throw e;\n      }\n    };\n\n    fn.assign(this, model.publicMethods); // Register dispatcher\n\n    this.dispatchToken = alt.dispatcher.register(function (payload) {\n      _this.preventDefault = false;\n\n      _this.lifecycle('beforeEach', {\n        payload: payload,\n        state: _this.state\n      });\n\n      var actionHandlers = model.actionListeners[payload.action];\n\n      if (actionHandlers || model.otherwise) {\n        var result = void 0;\n\n        if (actionHandlers) {\n          result = handleDispatch(function () {\n            return actionHandlers.filter(Boolean).every(function (handler) {\n              return handler.call(model, payload.data, payload.action) !== false;\n            });\n          }, payload);\n        } else {\n          result = handleDispatch(function () {\n            return model.otherwise(payload.data, payload.action);\n          }, payload);\n        }\n\n        if (result !== false && !_this.preventDefault) _this.emitChange();\n      }\n\n      if (model.reduce) {\n        handleDispatch(function () {\n          var value = model.reduce(_this.state, payload);\n          if (value !== undefined) _this.state = value;\n        }, payload);\n        if (!_this.preventDefault) _this.emitChange();\n      }\n\n      _this.lifecycle('afterEach', {\n        payload: payload,\n        state: _this.state\n      });\n    });\n    this.lifecycle('init');\n  }\n\n  AltStore.prototype.listen = function () {\n    function listen(cb) {\n      var _this2 = this;\n\n      if (!fn.isFunction(cb)) throw new TypeError('listen expects a function');\n\n      var _transmitter$subscrib = this.transmitter.subscribe(cb);\n\n      var dispose = _transmitter$subscrib.dispose;\n      this.subscriptions.push({\n        cb: cb,\n        dispose: dispose\n      });\n      return function () {\n        _this2.lifecycle('unlisten');\n\n        dispose();\n      };\n    }\n\n    return listen;\n  }();\n\n  AltStore.prototype.unlisten = function () {\n    function unlisten(cb) {\n      this.lifecycle('unlisten');\n      this.subscriptions.filter(function (subscription) {\n        return subscription.cb === cb;\n      }).forEach(function (subscription) {\n        return subscription.dispose();\n      });\n    }\n\n    return unlisten;\n  }();\n\n  AltStore.prototype.getState = function () {\n    function getState() {\n      return this.StoreModel.config.getState.call(this, this.state);\n    }\n\n    return getState;\n  }();\n\n  return AltStore;\n}();\n\nexports['default'] = AltStore;\nmodule.exports = exports['default'];","map":{"version":3,"sources":["D:/Projects/W_e_e_b/my-app/node_modules/alt/lib/store/AltStore.js"],"names":["Object","defineProperty","exports","value","_functions","require","fn","_interopRequireWildcard","_transmitter","_transmitter2","_interopRequireDefault","obj","__esModule","newObj","key","prototype","hasOwnProperty","call","_classCallCheck","instance","Constructor","TypeError","AltStore","alt","model","state","StoreModel","_this","lifecycleEvents","transmitter","lifecycle","event","x","publish","preventDefault","displayName","boundListeners","reduce","subscriptions","output","emitChange","handleDispatch","f","payload","e","handlesOwnErrors","error","assign","publicMethods","dispatchToken","dispatcher","register","actionHandlers","actionListeners","action","otherwise","result","filter","Boolean","every","handler","data","undefined","listen","cb","_this2","isFunction","_transmitter$subscrib","subscribe","dispose","push","unlisten","subscription","forEach","getState","config","module"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _functions = require('../functions');\n\nvar fn = _interopRequireWildcard(_functions);\n\nvar _transmitter = require('transmitter');\n\nvar _transmitter2 = _interopRequireDefault(_transmitter);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar AltStore = function () {\n  function AltStore(alt, model, state, StoreModel) {\n    var _this = this;\n\n    _classCallCheck(this, AltStore);\n\n    var lifecycleEvents = model.lifecycleEvents;\n    this.transmitter = (0, _transmitter2['default'])();\n    this.lifecycle = function (event, x) {\n      if (lifecycleEvents[event]) lifecycleEvents[event].publish(x);\n    };\n    this.state = state;\n\n    this.alt = alt;\n    this.preventDefault = false;\n    this.displayName = model.displayName;\n    this.boundListeners = model.boundListeners;\n    this.StoreModel = StoreModel;\n    this.reduce = model.reduce || function (x) {\n      return x;\n    };\n    this.subscriptions = [];\n\n    var output = model.output || function (x) {\n      return x;\n    };\n\n    this.emitChange = function () {\n      return _this.transmitter.publish(output(_this.state));\n    };\n\n    var handleDispatch = function handleDispatch(f, payload) {\n      try {\n        return f();\n      } catch (e) {\n        if (model.handlesOwnErrors) {\n          _this.lifecycle('error', {\n            error: e,\n            payload: payload,\n            state: _this.state\n          });\n          return false;\n        }\n\n        throw e;\n      }\n    };\n\n    fn.assign(this, model.publicMethods);\n\n    // Register dispatcher\n    this.dispatchToken = alt.dispatcher.register(function (payload) {\n      _this.preventDefault = false;\n\n      _this.lifecycle('beforeEach', {\n        payload: payload,\n        state: _this.state\n      });\n\n      var actionHandlers = model.actionListeners[payload.action];\n\n      if (actionHandlers || model.otherwise) {\n        var result = void 0;\n\n        if (actionHandlers) {\n          result = handleDispatch(function () {\n            return actionHandlers.filter(Boolean).every(function (handler) {\n              return handler.call(model, payload.data, payload.action) !== false;\n            });\n          }, payload);\n        } else {\n          result = handleDispatch(function () {\n            return model.otherwise(payload.data, payload.action);\n          }, payload);\n        }\n\n        if (result !== false && !_this.preventDefault) _this.emitChange();\n      }\n\n      if (model.reduce) {\n        handleDispatch(function () {\n          var value = model.reduce(_this.state, payload);\n          if (value !== undefined) _this.state = value;\n        }, payload);\n        if (!_this.preventDefault) _this.emitChange();\n      }\n\n      _this.lifecycle('afterEach', {\n        payload: payload,\n        state: _this.state\n      });\n    });\n\n    this.lifecycle('init');\n  }\n\n  AltStore.prototype.listen = function () {\n    function listen(cb) {\n      var _this2 = this;\n\n      if (!fn.isFunction(cb)) throw new TypeError('listen expects a function');\n\n      var _transmitter$subscrib = this.transmitter.subscribe(cb);\n\n      var dispose = _transmitter$subscrib.dispose;\n\n      this.subscriptions.push({ cb: cb, dispose: dispose });\n      return function () {\n        _this2.lifecycle('unlisten');\n        dispose();\n      };\n    }\n\n    return listen;\n  }();\n\n  AltStore.prototype.unlisten = function () {\n    function unlisten(cb) {\n      this.lifecycle('unlisten');\n      this.subscriptions.filter(function (subscription) {\n        return subscription.cb === cb;\n      }).forEach(function (subscription) {\n        return subscription.dispose();\n      });\n    }\n\n    return unlisten;\n  }();\n\n  AltStore.prototype.getState = function () {\n    function getState() {\n      return this.StoreModel.config.getState.call(this, this.state);\n    }\n\n    return getState;\n  }();\n\n  return AltStore;\n}();\n\nexports['default'] = AltStore;\nmodule.exports = exports['default'];"]},"metadata":{},"sourceType":"script"}